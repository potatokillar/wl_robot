# system_bringup - IIRI ç³»ç»Ÿåˆ†å±‚å¯åŠ¨åŒ…

## æ¦‚è¿°

`system_bringup` æ˜¯ IIRI ROS2 åˆ†å±‚æ¶æ„çš„ç³»ç»Ÿçº§å¯åŠ¨åŒ…ï¼Œä½äº **core_layer**ï¼Œæ”¯æŒæŒ‰å±‚çº§å’Œå¹³å°ç‰¹å®šçš„æ–¹å¼å¯åŠ¨ ROS2 èŠ‚ç‚¹ã€‚

### ä¸»è¦ç‰¹æ€§

- âœ… **åˆ†å±‚å¯åŠ¨**: æ”¯æŒç‹¬ç«‹å¯åŠ¨ä»»æ„å±‚çº§ï¼ˆç¡¬ä»¶å±‚ã€æ„ŸçŸ¥å±‚ã€æ™ºèƒ½å±‚ã€åº”ç”¨å±‚ï¼‰
- âœ… **å¹³å°é€‚é…**: é’ˆå¯¹ä¸åŒç¡¬ä»¶å¹³å°ï¼ˆæ ‘è“æ´¾ã€Orinã€ARMã€x86ï¼‰è‡ªåŠ¨é…ç½®
- âœ… **ä¾èµ–æ£€æŸ¥**: è‡ªåŠ¨æ£€æµ‹æ‰€éœ€åŒ…æ˜¯å¦å®‰è£…
- âœ… **çµæ´»é…ç½®**: é€šè¿‡å¯åŠ¨å‚æ•°æ§åˆ¶åŠŸèƒ½æ¨¡å—çš„å¼€å…³
- âœ… **è§£è€¦ç¼–è¯‘**: æ— éœ€ç¼–è¯‘å®Œæ•´5å±‚å³å¯è¿è¡Œç³»ç»Ÿï¼ˆè§£å†³äº†ä¹‹å‰ bringup åœ¨åº”ç”¨å±‚çš„é—®é¢˜ï¼‰

## æ¶æ„è®¾è®¡è¯´æ˜

### ä¸¤ç§ Launch æ–‡ä»¶ç±»å‹

system_bringup æä¾›ä¸¤ç§ç±»å‹çš„ launch æ–‡ä»¶ï¼Œåˆ†åˆ«ç”¨äºä¸åŒåœºæ™¯ï¼š

#### 1. **layer/** - å±‚çº§é€’å¢å¼å¯åŠ¨ï¼ˆå¼€å‘è°ƒè¯•ç”¨ï¼‰

æ¯ä¸€å±‚éƒ½**è‡ªåŠ¨åŒ…å«**æ‰€æœ‰ä¸‹å±‚èŠ‚ç‚¹ï¼Œå®ç°çœŸæ­£çš„é€’å¢å¼å¯åŠ¨ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4_application.launch.py (13ä¸ªèŠ‚ç‚¹)                      â”‚
â”‚ â”œâ”€â”€ include: 3_intelligence.launch.py                   â”‚
â”‚ â”‚   â”œâ”€â”€ include: 2_perception.launch.py                 â”‚
â”‚ â”‚   â”‚   â”œâ”€â”€ include: 1_hardware.launch.py               â”‚
â”‚ â”‚   â”‚   â”‚   â”œâ”€â”€ motion_control âš™ï¸                       â”‚
â”‚ â”‚   â”‚   â”‚   â””â”€â”€ robot_base âš™ï¸                           â”‚
â”‚ â”‚   â”‚   â”œâ”€â”€ camera_ptz ğŸ“·                               â”‚
â”‚ â”‚   â”‚   â”œâ”€â”€ speaker ğŸ”Š                                  â”‚
â”‚ â”‚   â”‚   â”œâ”€â”€ tts ğŸ—£ï¸                                      â”‚
â”‚ â”‚   â”‚   â””â”€â”€ speech_recognition ğŸ¤                       â”‚
â”‚ â”‚   â”œâ”€â”€ bt_manager ğŸ§                                     â”‚
â”‚ â”‚   â”œâ”€â”€ xiaozhi ğŸ’¬                                      â”‚
â”‚ â”‚   â””â”€â”€ smart_follow ğŸš¶                                 â”‚
â”‚ â”œâ”€â”€ dev_server ğŸ–¥ï¸                                       â”‚
â”‚ â”œâ”€â”€ remote_ctrl ğŸ“¡                                      â”‚
â”‚ â”œâ”€â”€ record ğŸ™ï¸                                           â”‚
â”‚ â””â”€â”€ key_control âŒ¨ï¸                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å±‚çº§èŠ‚ç‚¹ç´¯ç§¯è¡¨**ï¼š

| Launch æ–‡ä»¶ | åŒ…å«çš„å±‚çº§ | èŠ‚ç‚¹æ€»æ•° | æ–°å¢èŠ‚ç‚¹ |
|------------|----------|---------|---------|
| `1_hardware.launch.py` | ç¬¬1å±‚ | 2ä¸ª | motion_control, robot_base |
| `2_perception.launch.py` | ç¬¬1+2å±‚ | 6ä¸ª | + camera_ptz, speaker, tts, speech_recognition |
| `3_intelligence.launch.py` | ç¬¬1+2+3å±‚ | 9ä¸ª | + bt_manager, xiaozhi, smart_follow |
| `4_application.launch.py` | ç¬¬1+2+3+4å±‚ | 13ä¸ª | + dev_server, remote_ctrl, record, key_control |

**å…³é”®ç‰¹æ€§**ï¼š
- âœ… æ¯å±‚éƒ½ä¼š**é€’å½’åŒ…å«**ä¸‹å±‚çš„æ‰€æœ‰èŠ‚ç‚¹
- âœ… å¯åŠ¨é«˜å±‚æ—¶ï¼Œæ— éœ€æ‰‹åŠ¨å¯åŠ¨ä½å±‚
- âœ… é€‚åˆå¼€å‘æ—¶**ç²¾ç¡®æ§åˆ¶**å¯åŠ¨èŒƒå›´

#### 2. **platform/** - å¹³å°å¿«æ·å¯åŠ¨ï¼ˆç”Ÿäº§éƒ¨ç½²ç”¨ï¼‰

å¹³å°æ–‡ä»¶æ˜¯**å¿«æ·æ–¹å¼**ï¼Œç›´æ¥è·³è½¬åˆ°ç‰¹å®šå±‚çº§ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ platform/ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚  qr_debug.launch.py                    â”‚
â”‚      â””â”€â†’ 1_hardware (2ä¸ªèŠ‚ç‚¹)          â”‚
â”‚                                         â”‚
â”‚  qr_raspi.launch.py                    â”‚
â”‚      â””â”€â†’ 3_intelligence (9ä¸ªèŠ‚ç‚¹)      â”‚
â”‚                                         â”‚
â”‚  qr_arm.launch.py                      â”‚
â”‚      â””â”€â†’ 3_intelligence (9ä¸ªèŠ‚ç‚¹)      â”‚
â”‚                                         â”‚
â”‚  qr_orin.launch.py                     â”‚
â”‚      â””â”€â†’ 4_application (13ä¸ªèŠ‚ç‚¹)      â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¹³å°ç‰¹æ€§å¯¹æ¯”**ï¼š

| å¹³å° | ç›®æ ‡å±‚çº§ | èŠ‚ç‚¹æ•° | é€‚ç”¨åœºæ™¯ | ç¡¬ä»¶è¦æ±‚ |
|------|---------|--------|---------|---------|
| `qr_debug` | ç¬¬1å±‚ | 2ä¸ª | å¿«é€Ÿæµ‹è¯•ã€æ•…éšœè¯Šæ–­ | æœ€ä½ (2æ ¸2G) |
| `qr_raspi` | ç¬¬3å±‚ | 9ä¸ª | æ ‘è“æ´¾ä½åŠŸè€—éƒ¨ç½² | ä¸­ç­‰ (4æ ¸4G) |
| `qr_arm` | ç¬¬3å±‚ | 9ä¸ª | é€šç”¨ARMå¹³å° | ä¸­ç­‰ (4æ ¸8G) |
| `qr_orin` | ç¬¬4å±‚ | 13ä¸ª | é«˜æ€§èƒ½å®Œæ•´åŠŸèƒ½ | é«˜æ€§èƒ½ (12æ ¸32G+GPU) |

**å…³é”®ç‰¹æ€§**ï¼š
- âœ… ä¸€é”®å¯åŠ¨ï¼Œè‡ªåŠ¨é€‰æ‹©åˆé€‚å±‚çº§
- âœ… é¢„è®¾å¹³å°ä¼˜åŒ–å‚æ•°
- âœ… é€‚åˆç”Ÿäº§ç¯å¢ƒ**å¿«é€Ÿéƒ¨ç½²**

### å®Œæ•´çš„å¯åŠ¨å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ platform/ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                 â”‚
â”‚  qr_debug.launch.py â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚                                â†“                â”‚
â”‚  qr_raspi.launch.py â”€â”€â”€â”€â”€â”    â†“                â”‚
â”‚                           â†“    â†“                â”‚
â”‚  qr_arm.launch.py â”€â”€â”€â”€â”   â†“    â†“                â”‚
â”‚                        â†“   â†“    â†“                â”‚
â”‚  qr_orin.launch.py â”€â” â†“   â†“    â†“                â”‚
â”‚                      â†“ â†“   â†“    â†“                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ â”‚   â”‚    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ layer/ â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             â”‚    â”‚                â”‚
â”‚  4_application.launch.py â—„â”€â”€â”˜    â”‚                â”‚
â”‚    â”œâ”€â”€ include: 3_intelligence   â”‚                â”‚
â”‚    â””â”€â”€ nodes: [åº”ç”¨å±‚4ä¸ªèŠ‚ç‚¹]    â”‚                â”‚
â”‚         â†‘                        â”‚                â”‚
â”‚         â”‚                        â”‚                â”‚
â”‚  3_intelligence.launch.py â—„â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚    â”œâ”€â”€ include: 2_perception     â”‚                â”‚
â”‚    â””â”€â”€ nodes: [æ™ºèƒ½å±‚3ä¸ªèŠ‚ç‚¹]    â”‚                â”‚
â”‚         â†‘                        â”‚                â”‚
â”‚         â”‚                        â”‚                â”‚
â”‚  2_perception.launch.py â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚    â”œâ”€â”€ include: 1_hardware                        â”‚
â”‚    â””â”€â”€ nodes: [æ„ŸçŸ¥å±‚4ä¸ªèŠ‚ç‚¹]                     â”‚
â”‚         â†‘                                         â”‚
â”‚         â”‚                                         â”‚
â”‚  1_hardware.launch.py (åŸºç¡€å±‚)                     â”‚
â”‚    â””â”€â”€ nodes: [ç¡¬ä»¶å±‚2ä¸ªèŠ‚ç‚¹]                      â”‚
â”‚                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä½¿ç”¨åœºæ™¯å¯¹æ¯”

#### åœºæ™¯1ï¼šå¼€å‘è°ƒè¯• - ä½¿ç”¨ layer/

```bash
# åœºæ™¯ï¼šæµ‹è¯•è¿åŠ¨æ§åˆ¶åº•å±‚åŠŸèƒ½
ros2 launch system_bringup 1_hardware.launch.py
# åªå¯åŠ¨2ä¸ªèŠ‚ç‚¹ï¼Œå¿«é€ŸéªŒè¯ç¡¬ä»¶é€šä¿¡

# åœºæ™¯ï¼šå¼€å‘ç›¸æœºåŠŸèƒ½ï¼Œæš‚æ—¶ä¸éœ€è¦éŸ³é¢‘
ros2 launch system_bringup 2_perception.launch.py \
    enable_audio:=false
# å¯åŠ¨ç¡¬ä»¶+ç›¸æœºï¼Œç¦ç”¨éŸ³é¢‘æ¨¡å—

# åœºæ™¯ï¼šè°ƒè¯•å¯¼èˆªç®—æ³•
ros2 launch system_bringup 3_intelligence.launch.py
# å¯åŠ¨å‰3å±‚ï¼ŒåŒ…å«å¯¼èˆªæ‰€éœ€çš„æ‰€æœ‰ä¾èµ–

# åœºæ™¯ï¼šå®Œæ•´ç³»ç»Ÿé›†æˆæµ‹è¯•
ros2 launch system_bringup 4_application.launch.py
# å¯åŠ¨æ‰€æœ‰13ä¸ªèŠ‚ç‚¹
```

#### åœºæ™¯2ï¼šç”Ÿäº§éƒ¨ç½² - ä½¿ç”¨ platform/

```bash
# åœºæ™¯ï¼šæ ‘è“æ´¾æœºå™¨äººç°åœºéƒ¨ç½²
ros2 launch system_bringup qr_raspi.launch.py
# ä¸€é”®å¯åŠ¨9ä¸ªèŠ‚ç‚¹ï¼ˆè‡ªåŠ¨åˆ°ç¬¬3å±‚ï¼‰ï¼Œä½åŠŸè€—è¿è¡Œ

# åœºæ™¯ï¼šOriné«˜æ€§èƒ½æœºå™¨äºº
ros2 launch system_bringup qr_orin.launch.py
# ä¸€é”®å¯åŠ¨13ä¸ªèŠ‚ç‚¹ï¼ˆè‡ªåŠ¨åˆ°ç¬¬4å±‚ï¼‰ï¼Œå……åˆ†åˆ©ç”¨GPU

# åœºæ™¯ï¼šç°åœºå¿«é€Ÿæ•…éšœæ’æŸ¥
ros2 launch system_bringup qr_debug.launch.py
# æœ€å°åŒ–å¯åŠ¨ï¼ˆä»…2ä¸ªèŠ‚ç‚¹ï¼‰ï¼Œå¿«é€Ÿå®šä½é—®é¢˜
```

### è®¾è®¡ç†å¿µ

1. **layer/ æ–‡ä»¶**ï¼š
   - ğŸ¯ ç›®æ ‡ï¼šçµæ´»æ€§ã€å¯æ§æ€§
   - ğŸ‘¥ ç”¨æˆ·ï¼šå¼€å‘è€…ã€è°ƒè¯•äººå‘˜
   - ğŸ’¡ ç‰¹ç‚¹ï¼šç²¾ç¡®æ§åˆ¶ã€é€å±‚æµ‹è¯•

2. **platform/ æ–‡ä»¶**ï¼š
   - ğŸ¯ ç›®æ ‡ï¼šç®€å•æ€§ã€å¯é æ€§
   - ğŸ‘¥ ç”¨æˆ·ï¼šéƒ¨ç½²äººå‘˜ã€æœ€ç»ˆç”¨æˆ·
   - ğŸ’¡ ç‰¹ç‚¹ï¼šä¸€é”®å¯åŠ¨ã€é¢„è®¾ä¼˜åŒ–

## ç›®å½•ç»“æ„

```
system_bringup/
â”œâ”€â”€ CMakeLists.txt                      # æ„å»ºé…ç½®
â”œâ”€â”€ package.xml                         # åŒ…ä¾èµ–å®šä¹‰
â”œâ”€â”€ README.md                           # æœ¬æ–‡æ¡£
â”œâ”€â”€ launch/
â”‚   â”œâ”€â”€ layer/                          # åˆ†å±‚å¯åŠ¨æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ 1_hardware.launch.py        # ç¡¬ä»¶å±‚å¯åŠ¨
â”‚   â”‚   â”œâ”€â”€ 2_perception.launch.py      # æ„ŸçŸ¥å±‚å¯åŠ¨ï¼ˆä¾èµ–ç¡¬ä»¶å±‚ï¼‰
â”‚   â”‚   â”œâ”€â”€ 3_intelligence.launch.py    # æ™ºèƒ½å±‚å¯åŠ¨ï¼ˆä¾èµ–æ„ŸçŸ¥å±‚ï¼‰
â”‚   â”‚   â””â”€â”€ 4_application.launch.py     # åº”ç”¨å±‚å¯åŠ¨ï¼ˆä¾èµ–æ™ºèƒ½å±‚ï¼‰
â”‚   â”œâ”€â”€ platform/                       # å¹³å°ç‰¹å®šå¯åŠ¨æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ qr_raspi.launch.py          # æ ‘è“æ´¾å¹³å°ï¼ˆ3å±‚ï¼‰
â”‚   â”‚   â”œâ”€â”€ qr_orin.launch.py           # Orinå¹³å°ï¼ˆ4å±‚ï¼‰
â”‚   â”‚   â”œâ”€â”€ qr_arm.launch.py            # é€šç”¨ARMå¹³å°ï¼ˆ3å±‚ï¼‰
â”‚   â”‚   â””â”€â”€ qr_debug.launch.py          # è°ƒè¯•å¹³å°ï¼ˆ1å±‚ï¼‰
â”‚   â”œâ”€â”€ feature/                        # åŠŸèƒ½ç‰¹å®šå¯åŠ¨ï¼ˆå¾…æ‰©å±•ï¼‰
â”‚   â””â”€â”€ composite/                      # ç»„åˆå¯åŠ¨é…ç½®ï¼ˆå¾…æ‰©å±•ï¼‰
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ layer_nodes.yaml                # å±‚çº§èŠ‚ç‚¹é…ç½®
â”‚   â””â”€â”€ platform_config.yaml            # å¹³å°é…ç½®
â””â”€â”€ scripts/
    â””â”€â”€ check_dependencies.py           # ä¾èµ–æ£€æŸ¥è„šæœ¬
```

## å¿«é€Ÿå¼€å§‹

### 1. ç¼–è¯‘ core_layer

```bash
# ç¼–è¯‘ core_layerï¼ˆåŒ…å« system_bringupï¼‰
./build_layered.sh core_layer

# æˆ–ç¼–è¯‘åˆ°æ™ºèƒ½å±‚ï¼ˆå¦‚æœéœ€è¦è¿è¡Œæ™ºèƒ½å±‚èŠ‚ç‚¹ï¼‰
./build_layered.sh intelligence_layer
```

### 2. æŒ‰å±‚çº§å¯åŠ¨

```bash
# å¯åŠ¨ç¡¬ä»¶å±‚ï¼ˆä»…è¿åŠ¨æ§åˆ¶å’Œåº•ç›˜ï¼‰
ros2 launch system_bringup 1_hardware.launch.py

# å¯åŠ¨åˆ°æ„ŸçŸ¥å±‚ï¼ˆç¡¬ä»¶ + ç›¸æœº/éŸ³é¢‘ï¼‰
ros2 launch system_bringup 2_perception.launch.py

# å¯åŠ¨åˆ°æ™ºèƒ½å±‚ï¼ˆç¡¬ä»¶ + æ„ŸçŸ¥ + å¯¼èˆª/è·Ÿéšï¼‰
ros2 launch system_bringup 3_intelligence.launch.py

# å¯åŠ¨åˆ°åº”ç”¨å±‚ï¼ˆå®Œæ•´ç³»ç»Ÿï¼‰
ros2 launch system_bringup 4_application.launch.py
```

### 3. æŒ‰å¹³å°å¯åŠ¨

```bash
# æ ‘è“æ´¾å¹³å°ï¼ˆ3å±‚æ¶æ„ï¼Œä½åŠŸè€—ï¼‰
ros2 launch system_bringup qr_raspi.launch.py

# Orinå¹³å°ï¼ˆ4å±‚æ¶æ„ï¼Œé«˜æ€§èƒ½ï¼‰
ros2 launch system_bringup qr_orin.launch.py

# é€šç”¨ARMå¹³å°
ros2 launch system_bringup qr_arm.launch.py

# è°ƒè¯•æ¨¡å¼ï¼ˆä»…ç¡¬ä»¶å±‚ï¼‰
ros2 launch system_bringup qr_debug.launch.py
```

## å¯åŠ¨å‚æ•°

### é€šç”¨å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `use_sim_time` | bool | false | æ˜¯å¦ä½¿ç”¨ä»¿çœŸæ—¶é—´ |

### åŠŸèƒ½å¼€å…³å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `enable_navigation` | bool | true | å¯ç”¨å¯¼èˆªæ¨¡å— |
| `enable_follow` | bool | false | å¯ç”¨æ™ºèƒ½è·Ÿéš |
| `enable_camera` | bool | true | å¯ç”¨ç›¸æœºPTZ |
| `enable_audio` | bool | true | å¯ç”¨éŸ³é¢‘æ¨¡å—ï¼ˆæ‰¬å£°å™¨/TTS/è¯­éŸ³è¯†åˆ«ï¼‰ |
| `enable_dev_server` | bool | true | å¯ç”¨å¼€å‘æœåŠ¡å™¨ |
| `enable_remote_ctrl` | bool | true | å¯ç”¨è¿œç¨‹æ§åˆ¶ |
| `enable_key_control` | bool | false | å¯ç”¨é”®ç›˜æ§åˆ¶ï¼ˆè°ƒè¯•ç”¨ï¼‰ |

### ä½¿ç”¨ç¤ºä¾‹

```bash
# æ ‘è“æ´¾ä¸Šå¯åŠ¨ï¼Œç¦ç”¨éŸ³é¢‘æ¨¡å—
ros2 launch system_bringup qr_raspi.launch.py enable_audio:=false

# æ™ºèƒ½å±‚å¯åŠ¨ï¼Œå¯ç”¨æ™ºèƒ½è·Ÿéš
ros2 launch system_bringup 3_intelligence.launch.py enable_follow:=true

# ç¡¬ä»¶å±‚å¯åŠ¨ï¼Œä½¿ç”¨ä»¿çœŸæ—¶é—´
ros2 launch system_bringup 1_hardware.launch.py use_sim_time:=true
```

## å±‚çº§ä¾èµ–å…³ç³»

```
4_application (åº”ç”¨å±‚)
    â”œâ”€â”€ dev_server
    â”œâ”€â”€ remote_ctrl
    â””â”€â”€ key_control
    â†“ ä¾èµ– â†“
3_intelligence (æ™ºèƒ½å±‚)
    â”œâ”€â”€ navigation
    â”œâ”€â”€ bt_manager
    â”œâ”€â”€ smart_follow
    â””â”€â”€ path_tracker
    â†“ ä¾èµ– â†“
2_perception (æ„ŸçŸ¥å±‚)
    â”œâ”€â”€ camera_ptz
    â”œâ”€â”€ speaker
    â”œâ”€â”€ tts
    â””â”€â”€ speech_recognition
    â†“ ä¾èµ– â†“
1_hardware (ç¡¬ä»¶å±‚)
    â”œâ”€â”€ motion_control
    â””â”€â”€ robot_base
```

## å¹³å°é…ç½®è¯´æ˜

### qr_raspi (æ ‘è“æ´¾)
- **æ¶æ„**: ARM aarch64
- **æœ€å¤§å±‚çº§**: 3 (æ™ºèƒ½å±‚)
- **é€‚ç”¨åœºæ™¯**: ä½åŠŸè€—ã€åŸºç¡€åŠŸèƒ½
- **æ€§èƒ½é…ç½®**:
  - æ§åˆ¶é¢‘ç‡: 30Hz
  - ç›¸æœºå¸§ç‡: 15fps
  - åœ°å›¾æ›´æ–°: 3Hz

### qr_orin (NVIDIA Orin)
- **æ¶æ„**: ARM aarch64 + GPU
- **æœ€å¤§å±‚çº§**: 4 (åº”ç”¨å±‚)
- **é€‚ç”¨åœºæ™¯**: é«˜æ€§èƒ½è®¡ç®—ã€å®Œæ•´åŠŸèƒ½
- **æ€§èƒ½é…ç½®**:
  - æ§åˆ¶é¢‘ç‡: 50Hz
  - ç›¸æœºå¸§ç‡: 30fps
  - åœ°å›¾æ›´æ–°: 5Hz
  - GPUåŠ é€Ÿ: å¯ç”¨

### qr_arm (é€šç”¨ARM)
- **æ¶æ„**: ARM aarch64
- **æœ€å¤§å±‚çº§**: 3 (æ™ºèƒ½å±‚)
- **é€‚ç”¨åœºæ™¯**: å¹³è¡¡æ€§èƒ½å’ŒåŠŸèƒ½
- **æ€§èƒ½é…ç½®**:
  - æ§åˆ¶é¢‘ç‡: 40Hz
  - ç›¸æœºå¸§ç‡: 20fps
  - åœ°å›¾æ›´æ–°: 4Hz

### qr_debug (è°ƒè¯•æ¨¡å¼)
- **æ¶æ„**: ä»»æ„
- **æœ€å¤§å±‚çº§**: 1 (ç¡¬ä»¶å±‚)
- **é€‚ç”¨åœºæ™¯**: å¿«é€Ÿæµ‹è¯•ã€æ•…éšœæ’æŸ¥
- **ç‰¹ç‚¹**: æœ€å°åŒ–é…ç½®ï¼Œå¯åŠ¨é€Ÿåº¦å¿«

## ä¾èµ–æ£€æŸ¥

ä½¿ç”¨ `check_dependencies.py` è„šæœ¬æ£€æŸ¥ç³»ç»Ÿä¾èµ–ï¼š

```bash
# æ£€æŸ¥æ‰€æœ‰å±‚çº§çš„ä¾èµ–
ros2 run system_bringup check_dependencies.py

# æ£€æŸ¥ç‰¹å®šå±‚çº§
ros2 run system_bringup check_dependencies.py hardware_layer
ros2 run system_bringup check_dependencies.py perception_layer
ros2 run system_bringup check_dependencies.py intelligence_layer
ros2 run system_bringup check_dependencies.py application_layer
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
ğŸ” IIRI ç³»ç»Ÿä¾èµ–æ£€æŸ¥
============================================================
ğŸ” æ£€æŸ¥ hardware_layer ä¾èµ–...
============================================================
  æ£€æŸ¥åŒ…: motion_control              âœ… å·²å®‰è£…
  æ£€æŸ¥åŒ…: robot_base                  âœ… å·²å®‰è£…
============================================================
âœ… å·²æ‰¾åˆ°: 2 ä¸ªåŒ…
âŒ ç¼ºå¤±:   0 ä¸ªåŒ…

âœ… æ‰€æœ‰ä¾èµ–å·²æ»¡è¶³ï¼
```

## ä¸ systemd é›†æˆ

å¯ä»¥å°† system_bringup é›†æˆåˆ° systemd æœåŠ¡ä¸­ï¼ˆæ›¿ä»£åŸæ¥ application_layer çš„ bringupï¼‰ï¼š

### ä¿®æ”¹ start_ros2_iiri_start.sh

```bash
#!/bin/bash

# åŠ è½½ ROS2 ç¯å¢ƒ
source /opt/ros/humble/setup.bash
source /home/wl/autorun/iiri-ros/install/setup.bash

# æ ¹æ®å¹³å°é€‰æ‹©å¯åŠ¨æ–‡ä»¶
PLATFORM="qr_raspi"  # æˆ– qr_orin, qr_arm, qr_debug

# å¯åŠ¨ç³»ç»Ÿ
ros2 launch system_bringup ${PLATFORM}.launch.py
```

### ä¼˜åŠ¿

1. **æ›´å¿«çš„ç¼–è¯‘æ—¶é—´**: åªéœ€ç¼–è¯‘åˆ°ç¬¬3å±‚ï¼ˆæ™ºèƒ½å±‚ï¼‰å³å¯åœ¨æ ‘è“æ´¾ä¸Šè¿è¡Œ
2. **æ›´çµæ´»çš„éƒ¨ç½²**: ä¸åŒå¹³å°ä½¿ç”¨ä¸åŒçš„å¯åŠ¨é…ç½®
3. **æ›´æ¸…æ™°çš„æ¶æ„**: å¯åŠ¨é€»è¾‘åœ¨ core_layerï¼Œä¸ä¾èµ–åº”ç”¨å±‚

## è¿ç§»æŒ‡å—

### ä»æ—§çš„ bringup åŒ…è¿ç§»

å¦‚æœä½ ä¹‹å‰ä½¿ç”¨ `application_layer/bringup` åŒ…ï¼š

1. **ç¼–è¯‘æ–°åŒ…**:
   ```bash
   ./build_layered.sh intelligence_layer  # æ ‘è“æ´¾/ARM
   # æˆ–
   ./build_layered.sh application_layer   # Orin/x86
   ```

2. **æ›´æ–°å¯åŠ¨å‘½ä»¤**:
   ```bash
   # æ—§æ–¹å¼
   ros2 launch bringup qr_raspi.launch.py

   # æ–°æ–¹å¼
   ros2 launch system_bringup qr_raspi.launch.py
   ```

3. **æ›´æ–° systemd æœåŠ¡**:
   ä¿®æ”¹ `/home/wl/autorun/iiri-ros/start_ros2_iiri_start.sh` ä¸­çš„å¯åŠ¨å‘½ä»¤

## æ•…éšœæ’æŸ¥

### å¯åŠ¨å¤±è´¥ï¼šæ‰¾ä¸åˆ°åŒ…

**åŸå› **: å¯¹åº”å±‚çº§æœªç¼–è¯‘

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥ä¾èµ–
ros2 run system_bringup check_dependencies.py

# ç¼–è¯‘ç¼ºå¤±çš„å±‚çº§
./build_layered.sh [layer_name]
```

### èŠ‚ç‚¹å¯åŠ¨ä½†æ— æ•°æ®

**åŸå› **: ä¸‹å±‚ä¾èµ–æœªå¯åŠ¨

**è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨æ›´é«˜å±‚çº§çš„å¯åŠ¨æ–‡ä»¶ï¼Œå®ƒä¼šè‡ªåŠ¨åŒ…å«ä¸‹å±‚èŠ‚ç‚¹

### æ€§èƒ½é—®é¢˜

**åŸå› **: å¹³å°é…ç½®ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆ**:
- æ ‘è“æ´¾ä½¿ç”¨ `qr_raspi.launch.py`
- Orin ä½¿ç”¨ `qr_orin.launch.py`
- æˆ–æ‰‹åŠ¨è°ƒæ•´å¯åŠ¨å‚æ•°

## æ‰©å±•å¼€å‘

### æ·»åŠ æ–°çš„å¹³å°é…ç½®

1. åœ¨ `config/platform_config.yaml` ä¸­æ·»åŠ å¹³å°å®šä¹‰
2. åœ¨ `launch/platform/` åˆ›å»ºæ–°çš„å¯åŠ¨æ–‡ä»¶
3. å‚è€ƒç°æœ‰å¹³å°æ–‡ä»¶ç¼–å†™å¯åŠ¨é€»è¾‘

### æ·»åŠ åŠŸèƒ½ç‰¹å®šå¯åŠ¨

åœ¨ `launch/feature/` ç›®å½•åˆ›å»ºåŠŸèƒ½å¯åŠ¨æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š
- `follow.launch.py` - åªå¯åŠ¨è·ŸéšåŠŸèƒ½
- `navigation.launch.py` - åªå¯åŠ¨å¯¼èˆªåŠŸèƒ½
- `speech_demo.launch.py` - è¯­éŸ³äº¤äº’æ¼”ç¤º

### æ·»åŠ ç»„åˆå¯åŠ¨é…ç½®

åœ¨ `launch/composite/` ç›®å½•åˆ›å»ºç»„åˆé…ç½®ï¼Œä¾‹å¦‚ï¼š
- `full_system.launch.py` - å®Œæ•´ç³»ç»Ÿ
- `minimal_system.launch.py` - æœ€å°ç³»ç»Ÿ
- `test_system.launch.py` - æµ‹è¯•ç³»ç»Ÿ

## å¸¸è§é—®é¢˜ (FAQ)

### Q: ä¸ºä»€ä¹ˆè¦æŠŠ bringup æ”¾åœ¨ core_layerï¼Ÿ

A: è§£å†³äº†åŸæ¥ bringup åœ¨ application_layer å¯¼è‡´å¿…é¡»ç¼–è¯‘å®Œæ•´5å±‚æ‰èƒ½è¿è¡Œçš„é—®é¢˜ã€‚ç°åœ¨åªéœ€ç¼–è¯‘åˆ°ç¬¬3å±‚ï¼ˆæ™ºèƒ½å±‚ï¼‰å³å¯åœ¨æ ‘è“æ´¾ä¸Šè¿è¡Œç³»ç»Ÿã€‚

### Q: å¦‚ä½•çŸ¥é“åº”è¯¥ä½¿ç”¨å“ªä¸ªå¯åŠ¨æ–‡ä»¶ï¼Ÿ

A:
- **æŒ‰å¹³å°**: ä½¿ç”¨ `qr_raspi.launch.py`ã€`qr_orin.launch.py` ç­‰
- **æŒ‰å±‚çº§**: ä½¿ç”¨ `1_hardware.launch.py` åˆ° `4_application.launch.py`
- **è°ƒè¯•**: ä½¿ç”¨ `qr_debug.launch.py`

### Q: å¯ä»¥åŒæ—¶å¯åŠ¨å¤šä¸ªå±‚çº§å—ï¼Ÿ

A: ä¸éœ€è¦ã€‚é«˜å±‚çº§çš„å¯åŠ¨æ–‡ä»¶ä¼šè‡ªåŠ¨åŒ…å«ä½å±‚çº§çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚ä¾‹å¦‚ `3_intelligence.launch.py` ä¼šè‡ªåŠ¨å¯åŠ¨ç¡¬ä»¶å±‚å’Œæ„ŸçŸ¥å±‚ã€‚

### Q: å¯åŠ¨å‚æ•°å¯ä»¥ç»„åˆä½¿ç”¨å—ï¼Ÿ

A: å¯ä»¥ã€‚æ‰€æœ‰å‚æ•°éƒ½å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­æŒ‡å®šï¼Œä¾‹å¦‚ï¼š
```bash
ros2 launch system_bringup qr_raspi.launch.py \
  enable_camera:=false \
  enable_audio:=false \
  enable_navigation:=true
```

## ç‰ˆæœ¬å†å²

### v1.0.0 (2025-10-10)
- âœ… åˆå§‹ç‰ˆæœ¬
- âœ… å®ç°4å±‚åˆ†å±‚å¯åŠ¨
- âœ… å®ç°4ç§å¹³å°é…ç½®
- âœ… æ·»åŠ ä¾èµ–æ£€æŸ¥è„šæœ¬
- âœ… å®Œæ•´çš„é…ç½®æ–‡ä»¶æ”¯æŒ

## è´¡çŒ®

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³» IIRI å¼€å‘å›¢é˜Ÿã€‚

## è®¸å¯è¯

Apache-2.0
