# Jenkins CI å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ¯ å¿«é€Ÿæ€»ç»“

Jenkins ä»»åŠ¡å·²æˆåŠŸé…ç½®ï¼ç°åœ¨å¯ä»¥è‡ªåŠ¨ç›‘æ§å’ŒéªŒè¯ä¸»åˆ†æ”¯çš„ç¼–è¯‘çŠ¶æ€ã€‚

## âœ… å·²å®Œæˆçš„é…ç½®

1. **Jenkins ä»»åŠ¡**: `iiri-layered-build-ci`
2. **Git å‡­æ®**: å·²é…ç½® `git-cred` (root/westlake)
3. **Jenkinsfile**: å·²æäº¤åˆ°ä¸»åˆ†æ”¯
4. **è‡ªåŠ¨è§¦å‘**: æ¯ 5 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ä»£ç å˜æ›´

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹å¼ 1: è®¿é—® Jenkins Web UI

```
æ‰“å¼€æµè§ˆå™¨è®¿é—®:
http://192.168.1.93:8080/job/iiri-layered-build-ci

ç‚¹å‡» "Build with Parameters" è§¦å‘æ„å»º
```

### æ–¹å¼ 2: ä½¿ç”¨è§¦å‘è„šæœ¬

```bash
# x86 æ¶æ„æ„å»ºï¼ˆé»˜è®¤ï¼‰
cd jenkins
./trigger_build.sh x86 false

# ARM æ¶æ„æ„å»ºï¼Œå¯ç”¨ Ceres ä¼˜åŒ–
./trigger_build.sh arm true
```

### æ–¹å¼ 3: è‡ªåŠ¨è§¦å‘ï¼ˆæ¨èï¼‰

ä»£ç æ¨é€åˆ° main åˆ†æ”¯åï¼ŒJenkins ä¼šåœ¨ 5 åˆ†é’Ÿå†…è‡ªåŠ¨æ£€æµ‹å¹¶å¼€å§‹æ„å»ºã€‚

## ğŸ“Š æŸ¥çœ‹æ„å»ºçŠ¶æ€

### æ„å»ºå†å²
http://192.168.1.93:8080/job/iiri-layered-build-ci/

### æœ€æ–°æ„å»ºæ—¥å¿—
http://192.168.1.93:8080/job/iiri-layered-build-ci/lastBuild/console

### ä½¿ç”¨å‘½ä»¤è¡ŒæŸ¥çœ‹ï¼ˆå¦‚æœ Jenkins CLI å¯ç”¨ï¼‰
```bash
# æŸ¥çœ‹æœ€æ–°æ„å»ºçŠ¶æ€
curl -s "http://admin:westlake@192.168.1.93:8080/job/iiri-layered-build-ci/lastBuild/api/json" \
  | python3 -c "import sys, json; d=json.load(sys.stdin); print(f\"ç»“æœ: {d['result']}, ç¼–å·: {d['number']}\")"
```

## ğŸ”§ æ„å»ºæµç¨‹è¯´æ˜

ä»»åŠ¡ä¼šæŒ‰ä»¥ä¸‹é¡ºåºæ‰§è¡Œï¼š

```
1. æ¸…ç†å·¥ä½œç©ºé—´
2. æ‹‰å–ä¸»ä»“åº“ (main åˆ†æ”¯)
3. é…ç½® Git å‡­æ® (ç”¨äº vcstool)
4. ä½¿ç”¨ ./sync.sh import å¯¼å…¥æ‰€æœ‰åˆ†å±‚ä»“åº“
5. æŒ‰é¡ºåºæ¸…ç†æ„å»ºå„å±‚:
   â”œâ”€â”€ Core Layer
   â”œâ”€â”€ Hardware Layer
   â”œâ”€â”€ Perception Layer
   â”œâ”€â”€ Intelligence Layer
   â””â”€â”€ Application Layer
6. æ¸…ç†æ„å»ºäº§ç‰©
```

## âš™ï¸ æ„å»ºå‚æ•°

- **ARCHITECTURE**:
  - `x86` (é»˜è®¤) - x86_64 æ¶æ„
  - `arm` - ARM/aarch64 æ¶æ„

- **ENABLE_CERES**:
  - `false` (é»˜è®¤) - å¿«é€Ÿæ„å»º
  - `true` - å¯ç”¨ Ceres ä¼˜åŒ–ï¼ˆç”¨äº path_trackerï¼‰

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: Git åˆ†æ”¯ä¸å­˜åœ¨é”™è¯¯

**ç°è±¡**:
```
fatal: couldn't find remote ref refs/heads/main
```

**åŸå› **: Jenkins é…ç½®çš„åˆ†æ”¯åç§°ä¸å®é™…åˆ†æ”¯åç§°ä¸åŒ¹é…

**è§£å†³æ–¹æ³•**:
âœ… **å·²ä¿®å¤**: Jenkinsfile å’Œ job-config.xml å·²æ›´æ–°ä¸ºä½¿ç”¨ `master` åˆ†æ”¯

å¦‚æœä»æœ‰é—®é¢˜ï¼Œæ£€æŸ¥ï¼š
1. Git ä»“åº“çš„å®é™…åˆ†æ”¯åç§°: `git branch -a`
2. ç¡®ä¿ Jenkinsfile ä¸­ `GIT_BRANCH = 'master'`
3. ç¡®ä¿ job-config.xml ä¸­ `<name>*/master</name>`

### é—®é¢˜ 2: vcstool å¯¼å…¥å¤±è´¥

**ç°è±¡**: `./sync.sh import` å¤±è´¥

**è§£å†³æ–¹æ³•**:
1. æ£€æŸ¥ Jenkins æœåŠ¡å™¨èƒ½å¦è®¿é—® `192.168.1.55`:
   ```bash
   ping 192.168.1.55
   ```

2. æ£€æŸ¥ Git å‡­æ®æ˜¯å¦æ­£ç¡®é…ç½®

3. æ‰‹åŠ¨åœ¨ Jenkins æœåŠ¡å™¨ä¸Šæµ‹è¯•:
   ```bash
   git clone http://root:westlake@192.168.1.55/ontology/iiri_ros2_architecture.git
   ```

### é—®é¢˜ 3: ç¼–è¯‘å¤±è´¥

**æŸ¥çœ‹è¯¦ç»†æ—¥å¿—**:
http://192.168.1.93:8080/job/iiri-layered-build-ci/lastBuild/console

**å¸¸è§åŸå› **:
- Docker é•œåƒæ— æ³•æ‹‰å–
- æŸä¸€å±‚ä»£ç ç¼–è¯‘é”™è¯¯
- ä¾èµ–åŒ…ç¼ºå¤±

**è§£å†³æ–¹æ³•**:
1. æŸ¥çœ‹å…·ä½“å“ªä¸€å±‚å¤±è´¥
2. åœ¨æœ¬åœ°å¤ç°é—®é¢˜: `./build_layered.sh -c x86 [å¤±è´¥çš„å±‚]`
3. ä¿®å¤ä»£ç åé‡æ–°æ¨é€

### é—®é¢˜ 4: æ„å»ºè§¦å‘å¤±è´¥

å¦‚æœè§¦å‘è„šæœ¬è¶…æ—¶ï¼Œå¯ä»¥ç›´æ¥è®¿é—® Jenkins UI æ‰‹åŠ¨è§¦å‘ã€‚

## ğŸ“ ç»´æŠ¤å»ºè®®

1. **å®šæœŸæ£€æŸ¥æ„å»ºçŠ¶æ€**: æ¯å¤©æŸ¥çœ‹æ˜¯å¦æœ‰å¤±è´¥çš„æ„å»º
2. **åŠæ—¶ä¿®å¤é—®é¢˜**: å‘ç°æ„å»ºå¤±è´¥åº”ç«‹å³ä¿®å¤
3. **ä¿æŒ Docker é•œåƒæ›´æ–°**: å®šæœŸæ›´æ–°æ„å»ºé•œåƒ
4. **ç›‘æ§ç£ç›˜ç©ºé—´**: Jenkins ä¼šå ç”¨å¤§é‡ç£ç›˜ç©ºé—´

## ğŸ”— ç›¸å…³é“¾æ¥

- **Jenkins ä»»åŠ¡**: http://192.168.1.93:8080/job/iiri-layered-build-ci
- **è¯¦ç»†æ–‡æ¡£**: [docs/JENKINS_CI_SETUP.md](../docs/JENKINS_CI_SETUP.md)
- **é¡¹ç›®æ–‡æ¡£**: [README.md](../README.md)
- **å¼€å‘æŒ‡å—**: [CLAUDE.md](../CLAUDE.md)

## ğŸ“ è·å–å¸®åŠ©

é‡åˆ°é—®é¢˜ï¼Ÿ
1. æŸ¥çœ‹æ„å»ºæ—¥å¿—æ‰¾åˆ°å…·ä½“é”™è¯¯
2. å‚è€ƒè¯¦ç»†æ–‡æ¡£ `docs/JENKINS_CI_SETUP.md`
3. è”ç³»å›¢é˜ŸæŠ€æœ¯è´Ÿè´£äºº

---

**ğŸ‰ Jenkins CI å·²é…ç½®å®Œæˆï¼Œç¥æ„å»ºæ„‰å¿«ï¼**
