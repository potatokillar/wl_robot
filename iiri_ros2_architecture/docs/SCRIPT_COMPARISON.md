# è„šæœ¬å¯¹æ¯”è¯´æ˜

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜é¡¹ç›®ä¸­å„ä¸ªåˆå§‹åŒ–å’Œæ„å»ºè„šæœ¬çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯ã€‚

## ğŸ“Š å¿«é€Ÿå¯¹æ¯”è¡¨

| è„šæœ¬ | ä¸»è¦åŠŸèƒ½ | ç›®æ ‡ç”¨æˆ· | ç³»ç»Ÿä¾èµ– | Dockeré•œåƒ | ä»£ç å¯¼å…¥ | ç¼–è¯‘ |
|------|---------|---------|---------|-----------|---------|------|
| **setup-and-build.sh** | ä¸€é”®åˆå§‹åŒ–+ç¼–è¯‘ | ğŸ†• æ–°äºº | âŒ ä¸å®‰è£… | âœ… æ‹‰å– | âœ… å¯¼å…¥ | âœ… ç¼–è¯‘ |
| **install.sh** | ç³»ç»Ÿç¯å¢ƒå‡†å¤‡ | ğŸ”§ ç¯å¢ƒé…ç½® | âœ… å®‰è£… | âŒ ä¸å¤„ç† | âœ… å¯¼å…¥ | âŒ ä¸ç¼–è¯‘ |
| **build.sh** | å¿«é€Ÿç¼–è¯‘ | ğŸ‘¨â€ğŸ’» å¼€å‘è€… | âŒ ä¸å®‰è£… | âš ï¸ æ£€æŸ¥ | âŒ ä¸å¯¼å…¥ | âœ… ç¼–è¯‘ |
| **build_layered.sh** | åˆ†å±‚ç¼–è¯‘ | ğŸ‘¨â€ğŸ’» å¼€å‘è€… | âŒ ä¸å®‰è£… | âš ï¸ æ£€æŸ¥ | âŒ ä¸å¯¼å…¥ | âœ… ç¼–è¯‘ |

---

## ğŸ¯ è„šæœ¬è¯¦ç»†è¯´æ˜

### 1. setup-and-build.sh - ä¸€é”®åˆå§‹åŒ–å’Œç¼–è¯‘

**å®šä½**ï¼šæ–°äººå‹å¥½çš„ä¸€é”®è„šæœ¬

**åŠŸèƒ½æ¸…å•**ï¼š
- âœ… æ£€æŸ¥ Docker ç¯å¢ƒ
- âœ… Harbor è‡ªåŠ¨ç™»å½•ï¼ˆå¯è·³è¿‡ï¼‰
- âœ… æ‹‰å– Docker é•œåƒï¼ˆæ™ºèƒ½åˆ¤æ–­ï¼Œå­˜åœ¨åˆ™è·³è¿‡ï¼‰
- âœ… å¯¼å…¥ä»£ç ï¼ˆå¦‚æœ src/ ç›®å½•ä¸ºç©ºï¼‰
- âœ… æ‰§è¡Œç¼–è¯‘

**ä½¿ç”¨åœºæ™¯**ï¼š
```bash
# åœºæ™¯1: æ–°äººé¦–æ¬¡è®¾ç½®
./setup-and-build.sh

# åœºæ™¯2: æ›´æ–°é•œåƒ
./setup-and-build.sh --pull-only --force

# åœºæ™¯3: è·³è¿‡å·²å®Œæˆæ­¥éª¤
./setup-and-build.sh --skip-login --skip-import

# åœºæ™¯4: åªæ‹‰å–é•œåƒä¸ç¼–è¯‘
./setup-and-build.sh --pull-only
```

**ä¼˜ç‚¹**ï¼š
- âš¡ ä¸€æ¡å‘½ä»¤å®Œæˆæ‰€æœ‰æ­¥éª¤
- ğŸ” æ™ºèƒ½æ£€æµ‹ï¼Œé¿å…é‡å¤æ“ä½œ
- ğŸ›¡ï¸ é”™è¯¯å¤„ç†å®Œå–„ï¼Œå¤±è´¥æ—¶æœ‰æ¸…æ™°æç¤º

**ç¼ºç‚¹**ï¼š
- âŒ ä¸å®‰è£…ç³»ç»Ÿä¾èµ–ï¼ˆéœ€è¦ç¯å¢ƒå·²æœ‰ Dockerã€git ç­‰ï¼‰
- âŒ ä¸æ”¯æŒ vcstool é…ç½®åˆ‡æ¢

**é€‚åˆäººç¾¤**ï¼š
- ğŸ†• æ–°äººé¦–æ¬¡è®¾ç½®ç¯å¢ƒ
- ğŸ”„ éœ€è¦æ›´æ–°é•œåƒçš„è€ç”¨æˆ·
- ğŸš€ å¸Œæœ›å¿«é€Ÿé‡æ–°ç¼–è¯‘çš„å¼€å‘è€…

---

### 2. install.sh - ç³»ç»Ÿç¯å¢ƒå®‰è£…

**å®šä½**ï¼šç³»ç»Ÿç¯å¢ƒå‡†å¤‡å’Œé…ç½®ç®¡ç†

**åŠŸèƒ½æ¸…å•**ï¼š
- âœ… å®‰è£…ç³»ç»Ÿä¾èµ–ï¼ˆapt-get installï¼‰
  - git, curl, python3-vcstool
  - build-essential, cmake
  - python3-rosdep, python3-argcomplete
- âœ… rosdep åˆå§‹åŒ–
- âœ… é…ç½® vcstoolï¼ˆæ”¯æŒ main/devel/stable åˆ‡æ¢ï¼‰
- âœ… å¯¼å…¥åˆ†å±‚ä»£ç 
- âŒ ä¸å¤„ç† Docker é•œåƒ
- âŒ ä¸æ‰§è¡Œç¼–è¯‘

**ä½¿ç”¨åœºæ™¯**ï¼š
```bash
# åœºæ™¯1: å…¨æ–°ç³»ç»Ÿï¼Œé¦–æ¬¡å®‰è£…
./install.sh

# åœºæ™¯2: åˆ‡æ¢åˆ°å¼€å‘åˆ†æ”¯
./install.sh --config devel

# åœºæ™¯3: åªå¯¼å…¥ä»£ç ï¼ˆå·²æœ‰ä¾èµ–ï¼‰
./install.sh --no-deps

# åœºæ™¯4: åˆ‡æ¢åˆ°ç¨³å®šç‰ˆæœ¬
./install.sh --config stable --no-deps
```

**ä¼˜ç‚¹**ï¼š
- âœ… å®‰è£…æ‰€æœ‰å¿…éœ€çš„ç³»ç»Ÿä¾èµ–
- âœ… æ”¯æŒé…ç½®åˆ‡æ¢ï¼ˆmain/devel/stableï¼‰
- âœ… å®Œæ•´çš„ç¯å¢ƒæ£€æŸ¥å’Œæç¤º

**ç¼ºç‚¹**ï¼š
- â±ï¸ éœ€è¦åç»­è¿è¡Œ setup-and-build.sh å®Œæˆç¼–è¯‘
- ğŸ” éœ€è¦ sudo æƒé™ï¼ˆå®‰è£…ç³»ç»ŸåŒ…ï¼‰

**é€‚åˆäººç¾¤**ï¼š
- ğŸ†• å…¨æ–°çš„ Ubuntu ç³»ç»Ÿ
- ğŸ”€ éœ€è¦åˆ‡æ¢åˆ†æ”¯é…ç½®çš„ç”¨æˆ·
- ğŸ”§ éœ€è¦å®‰è£…/æ›´æ–°ç³»ç»Ÿä¾èµ–çš„ç”¨æˆ·

**å®Œæˆå**ï¼š
```bash
# ç»§ç»­è¿è¡Œ
./setup-and-build.sh
```

---

### 3. build.sh - å¿«é€Ÿç¼–è¯‘è„šæœ¬

**å®šä½**ï¼šæ—¥å¸¸å¼€å‘çš„å¿«é€Ÿç¼–è¯‘å·¥å…·

**åŠŸèƒ½æ¸…å•**ï¼š
- âœ… æ£€æŸ¥ Docker é•œåƒï¼ˆä¸å­˜åœ¨ä¼šå°è¯•æ‹‰å–ï¼‰
- âœ… ç¼–è¯‘æ‰€æœ‰5å±‚
- âŒ ä¸å®‰è£…ç³»ç»Ÿä¾èµ–
- âŒ ä¸å¯¼å…¥ä»£ç 

**ä½¿ç”¨åœºæ™¯**ï¼š
```bash
# å¿«é€Ÿç¼–è¯‘æ‰€æœ‰å±‚
./build.sh

# æŒ‡å®šæ¶æ„ç¼–è¯‘
./build.sh x86
./build.sh arm

# æ¸…ç†é‡å»º
./build.sh -c
```

**ä¼˜ç‚¹**ï¼š
- âš¡ å¿«é€Ÿï¼Œç›´è¾¾ç¼–è¯‘
- ğŸ” è‡ªåŠ¨æ£€æŸ¥é•œåƒ

**ç¼ºç‚¹**ï¼š
- âŒ åŠŸèƒ½å•ä¸€ï¼Œåªè´Ÿè´£ç¼–è¯‘

---

### 4. build_layered.sh - åˆ†å±‚ç¼–è¯‘è„šæœ¬

**å®šä½**ï¼šç²¾ç»†æ§åˆ¶çš„åˆ†å±‚ç¼–è¯‘å·¥å…·

**åŠŸèƒ½æ¸…å•**ï¼š
- âœ… æ£€æŸ¥ Docker é•œåƒ
- âœ… ç¼–è¯‘æŒ‡å®šå±‚åŠå…¶ä¾èµ–
- âœ… æ”¯æŒ Ceres ä¼˜åŒ–é€‰é¡¹
- âŒ ä¸å®‰è£…ç³»ç»Ÿä¾èµ–
- âŒ ä¸å¯¼å…¥ä»£ç 

**ä½¿ç”¨åœºæ™¯**ï¼š
```bash
# ç¼–è¯‘åˆ°ç‰¹å®šå±‚
./build_layered.sh core_layer
./build_layered.sh intelligence_layer

# å¯ç”¨ Ceres ä¼˜åŒ–
./build_layered.sh --ceres intelligence_layer

# æ¸…ç†é‡å»ºç‰¹å®šå±‚
./build_layered.sh -c x86 perception_layer
```

**ä¼˜ç‚¹**ï¼š
- ğŸ¯ ç²¾ç¡®æ§åˆ¶ç¼–è¯‘èŒƒå›´
- âš¡ èŠ‚çœæ—¶é—´ï¼ˆåªç¼–è¯‘éœ€è¦çš„å±‚ï¼‰
- ğŸ”§ æ”¯æŒ Ceres ä¼˜åŒ–å¼€å…³

**ç¼ºç‚¹**ï¼š
- âŒ éœ€è¦äº†è§£åˆ†å±‚æ¶æ„
- âŒ å‚æ•°è¾ƒå¤šï¼Œå­¦ä¹ æ›²çº¿é™¡å³­

---

## ğŸš€ æ¨èä½¿ç”¨æµç¨‹

### åœºæ™¯Aï¼šå…¨æ–°æœºå™¨ï¼Œé¦–æ¬¡å®‰è£…ï¼ˆæ ‡å‡†æµç¨‹ï¼‰

```bash
# æ–°äººæ¨èæµç¨‹ï¼ˆä¸¤æ­¥ï¼‰
./install.sh            # æ­¥éª¤1: å®‰è£…ç³»ç»Ÿä¾èµ– + å¯¼å…¥ä»£ç 
./setup-and-build.sh    # æ­¥éª¤2: Harborç™»å½• + æ‹‰å–é•œåƒ + ç¼–è¯‘
```

**è¯´æ˜**ï¼š
- âœ… **æ¨èæ–°äººä½¿ç”¨è¿™ä¸ªæµç¨‹**
- `install.sh` ä¼šæ£€æŸ¥å¹¶å®‰è£…æ‰€æœ‰å¿…éœ€çš„ç³»ç»Ÿä¾èµ–
- å³ä½¿ç³»ç»Ÿå·²æœ‰æŸäº›ä¾èµ–ï¼Œè¿è¡Œ `install.sh` ä¹Ÿæ˜¯å®‰å…¨çš„ï¼ˆä¼šè·³è¿‡å·²å®‰è£…çš„ï¼‰

**ç‰¹æ®Šæƒ…å†µ**ï¼š
- å¦‚æœ**ç¡®è®¤**ç³»ç»Ÿå·²æœ‰æ‰€æœ‰ä¾èµ–ï¼ˆgitã€vcstoolã€Dockerï¼‰ï¼Œå¯ä»¥ï¼š
  ```bash
  ./install.sh --no-deps    # åªå¯¼å…¥ä»£ç 
  ./setup-and-build.sh      # æ‹‰é•œåƒ + ç¼–è¯‘
  ```

---

### åœºæ™¯Bï¼šæ›´æ–° Docker é•œåƒ

```bash
# å¼ºåˆ¶æ‹‰å–æœ€æ–°é•œåƒ
./setup-and-build.sh --pull-only --force

# æˆ–è€…æ‰‹åŠ¨
docker pull 192.168.1.93/iiri/build_x86_ros2:latest
```

---

### åœºæ™¯Cï¼šåˆ‡æ¢åˆ†æ”¯é…ç½®

```bash
# åˆ‡æ¢åˆ°å¼€å‘åˆ†æ”¯
./install.sh --config devel --no-deps

# æˆ–è€…æ‰‹åŠ¨
cp .repos.devel .repos
./sync.sh import
```

---

### åœºæ™¯Dï¼šæ—¥å¸¸å¼€å‘ç¼–è¯‘

```bash
# å¿«é€Ÿç¼–è¯‘æ‰€æœ‰å±‚
./build.sh

# æˆ–åªç¼–è¯‘ä¿®æ”¹çš„å±‚
./build_layered.sh intelligence_layer
```

---

### åœºæ™¯Eï¼šæ¸…ç†é‡å»º

```bash
# æ¸…ç†æ‰€æœ‰å±‚é‡å»º
./build.sh -c

# æˆ–æ¸…ç†ç‰¹å®šå±‚
./build_layered.sh -c perception_layer
```

---

## ğŸ’¡ å¸¸è§é—®é¢˜

### Q1: install.sh å’Œ setup-and-build.sh çš„åŒºåˆ«ï¼Ÿ

**A**: èŒè´£ä¸åŒï¼š
- `install.sh`ï¼šå®‰è£…ç³»ç»Ÿä¾èµ– + å¯¼å…¥ä»£ç ï¼ˆ**ä¸ç¼–è¯‘**ï¼‰
- `setup-and-build.sh`ï¼šDocker é•œåƒç®¡ç† + ç¼–è¯‘ï¼ˆ**ä¸è£…ä¾èµ–**ï¼‰

### Q2: æ–°äººåº”è¯¥ç”¨å“ªä¸ªè„šæœ¬ï¼Ÿ

**A**: **æ¨èæ–°äººéƒ½ä½¿ç”¨ä¸¤æ­¥æµç¨‹**ï¼š
```bash
./install.sh            # æ­¥éª¤1
./setup-and-build.sh    # æ­¥éª¤2
```

**åŸå› **ï¼š
- `install.sh` ä¼šè‡ªåŠ¨æ£€æŸ¥ä¾èµ–ï¼Œå·²å®‰è£…çš„ä¼šè·³è¿‡
- è¿™æ ·å¯ä»¥ç¡®ä¿ç¯å¢ƒå®Œæ•´ï¼Œé¿å…ç¼ºå°‘ä¾èµ–å¯¼è‡´åç»­å¤±è´¥
- å³ä½¿ç³»ç»Ÿå·²æœ‰æ‰€æœ‰ä¾èµ–ï¼Œè¿è¡Œ `install.sh` ä¹Ÿå¾ˆå¿«ï¼ˆè·³è¿‡å·²å®‰è£…çš„ï¼‰

### Q3: ä¸ºä»€ä¹ˆæœ‰è¿™ä¹ˆå¤šè„šæœ¬ï¼Ÿ

**A**: èŒè´£åˆ†ç¦»åŸåˆ™ï¼š
- `install.sh`ï¼šç³»ç»Ÿç¯å¢ƒå‡†å¤‡
- `setup-and-build.sh`ï¼šä¸€é”®åˆå§‹åŒ–
- `build.sh`ï¼šæ—¥å¸¸ç¼–è¯‘
- `build_layered.sh`ï¼šç²¾ç»†æ§åˆ¶

æ¯ä¸ªè„šæœ¬ä¸“æ³¨åšå¥½ä¸€ä»¶äº‹ï¼Œç»„åˆä½¿ç”¨æ›´çµæ´»ã€‚

### Q4: è€ç”¨æˆ·å¦‚ä½•æ›´æ–°é•œåƒï¼Ÿ

**A**:
```bash
./setup-and-build.sh --pull-only --force
```

### Q5: å¦‚ä½•åªå®‰è£…ä¾èµ–ä¸å¯¼å…¥ä»£ç ï¼Ÿ

**A**: ç›®å‰ `install.sh` ä¼šåŒæ—¶å®‰è£…ä¾èµ–å’Œå¯¼å…¥ä»£ç ã€‚å¦‚æœéœ€è¦å•ç‹¬æ“ä½œï¼š
```bash
# åªå®‰è£…ä¾èµ–
sudo apt-get install -y git python3-vcstool build-essential cmake

# å•ç‹¬å¯¼å…¥ä»£ç 
vcs import src < .repos
```

### Q6: ä¸ºä»€ä¹ˆ setup-and-build.sh ä¸å®‰è£…ç³»ç»Ÿä¾èµ–ï¼Ÿ

**A**: è®¾è®¡ç†å¿µï¼š
- ç³»ç»Ÿä¾èµ–å®‰è£…éœ€è¦ `sudo` æƒé™ï¼Œå±äºä¸€æ¬¡æ€§æ“ä½œ
- Docker é•œåƒç®¡ç†å’Œç¼–è¯‘æ˜¯æ—¥å¸¸æ“ä½œï¼Œä¸éœ€è¦ `sudo`
- èŒè´£åˆ†ç¦»ï¼Œé¿å…è„šæœ¬æƒé™æ··ä¹±

---

## ğŸ“ è„šæœ¬é€‰æ‹©å†³ç­–æ ‘

```
å¼€å§‹
  â”‚
  â”œâ”€ é¦–æ¬¡å…‹éš†é¡¹ç›®ï¼Ÿ
  â”‚   â”œâ”€ æ˜¯ â†’ ./install.sh â†’ ./setup-and-build.sh ï¼ˆæ ‡å‡†æµç¨‹ï¼‰
  â”‚   â””â”€ å¦ â†“
  â”‚
  â”œâ”€ éœ€è¦æ›´æ–° Docker é•œåƒï¼Ÿ
  â”‚   â”œâ”€ æ˜¯ â†’ ./setup-and-build.sh --pull-only --force
  â”‚   â””â”€ å¦ â†“
  â”‚
  â”œâ”€ éœ€è¦åˆ‡æ¢åˆ†æ”¯é…ç½®ï¼Ÿ
  â”‚   â”œâ”€ æ˜¯ â†’ ./install.sh --config devel --no-deps
  â”‚   â””â”€ å¦ â†“
  â”‚
  â”œâ”€ åªéœ€è¦é‡æ–°ç¼–è¯‘ï¼Ÿ
  â”‚   â”œâ”€ ç¼–è¯‘æ‰€æœ‰å±‚ â†’ ./build.sh
  â”‚   â””â”€ ç¼–è¯‘ç‰¹å®šå±‚ â†’ ./build_layered.sh [layer_name]
  â”‚
  â””â”€ å®Œæˆ
```

**ç®€åŒ–è¯´æ˜**ï¼š
- ğŸ†• **æ–°äºº**ï¼šæ— è„‘æ‰§è¡Œ `./install.sh` â†’ `./setup-and-build.sh`
- ğŸ”„ **æ›´æ–°é•œåƒ**ï¼š`./setup-and-build.sh --pull-only --force`
- ğŸ”€ **åˆ‡æ¢é…ç½®**ï¼š`./install.sh --config devel --no-deps`
- ğŸ”¨ **æ—¥å¸¸ç¼–è¯‘**ï¼š`./build.sh` æˆ– `./build_layered.sh`

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [README.md](../README.md) - é¡¹ç›®ä¸»æ–‡æ¡£
- [Docker ä½¿ç”¨æŒ‡å—](./development/docker-guide.md) - Docker é•œåƒç®¡ç†è¯¦è§£
- [vcstool ä½¿ç”¨æŒ‡å—](./development/vcstool-guide.md) - ä»£ç ç®¡ç†è¯¦è§£
- [æ„å»ºç³»ç»ŸæŒ‡å—](./development/build-guide.md) - ç¼–è¯‘ç³»ç»Ÿè¯¦è§£

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
**æœ€åæ›´æ–°**: 2024-10-13
**ç»´æŠ¤è€…**: IIRI DevOps Team
